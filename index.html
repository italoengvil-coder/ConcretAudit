<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SUPERMIX - Sistema de Inspe√ß√£o</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: #f0f0f0;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        /* Header estilo Receitas Autom√°ticas */
        .header {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            gap: 30px;
        }

        .logo-area {
            border-right: 2px solid #e0e0e0;
            padding-right: 30px;
        }

        .logo-supermix {
            font-size: 2em;
            font-weight: 700;
            color: #333;
            letter-spacing: 1px;
        }

        .logo-supermix small {
            font-size: 0.3em;
            display: block;
            color: #666;
            font-weight: normal;
        }

        .since {
            font-size: 0.8em;
            color: #999;
        }

        .title-area h1 {
            color: #333;
            font-size: 1.5em;
            font-weight: 600;
        }

        .title-area p {
            color: #666;
            font-size: 0.9em;
        }

        /* Grid de informa√ß√µes */
        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .info-item {
            display: flex;
            flex-direction: column;
        }

        .info-item label {
            font-size: 0.8em;
            color: #666;
            margin-bottom: 5px;
            text-transform: uppercase;
            font-weight: 600;
        }

        .info-item input, .info-item select {
            padding: 10px;
            border: 1px solid #e0e0e0;
            border-radius: 4px;
            font-size: 0.9em;
            transition: all 0.3s;
        }

        .info-item input:focus, .info-item select:focus {
            outline: none;
            border-color: #999;
            box-shadow: 0 0 5px rgba(0,0,0,0.1);
        }

        /* Barra de progresso */
        .progress-container {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #f0f0f0;
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: #333;
            transition: width 0.3s ease;
            width: 0%;
        }

        .stats {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .stat {
            font-size: 0.9em;
            color: #666;
        }

        .stat strong {
            color: #333;
            font-size: 1.2em;
            margin-right: 5px;
        }

        /* Cards de gr√°ficos */
        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .chart-card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .chart-card h3 {
            color: #333;
            font-size: 1.1em;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #f0f0f0;
        }

        .chart-container {
            height: 200px;
            position: relative;
        }

        .bar-chart {
            display: flex;
            align-items: flex-end;
            height: 150px;
            gap: 20px;
            justify-content: center;
        }

        .bar-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 60px;
        }

        .bar {
            width: 40px;
            background: #333;
            border-radius: 4px 4px 0 0;
            transition: height 0.3s;
            min-height: 5px;
        }

        .bar-label {
            margin-top: 8px;
            font-size: 0.8em;
            color: #666;
            text-align: center;
        }

        .bar-value {
            font-size: 0.7em;
            color: #999;
            margin-bottom: 5px;
        }

        .pie-chart {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            margin: 0 auto;
            background: conic-gradient(#28a745 0% 75%, #dc3545 75% 100%);
        }

        .legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 15px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.85em;
        }

        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 3px;
        }

        /* Navega√ß√£o por grupos */
        .group-nav {
            background: white;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .group-tabs {
            display: flex;
            background: #f8f8f8;
            border-bottom: 1px solid #e0e0e0;
        }

        .group-tab {
            flex: 1;
            padding: 15px;
            cursor: pointer;
            color: #666;
            font-weight: 500;
            text-align: center;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
        }

        .group-tab:hover {
            color: #333;
            background: #f0f0f0;
        }

        .group-tab.active {
            color: #333;
            border-bottom-color: #333;
            background: white;
        }

        .group-content {
            padding: 20px;
        }

        /* Sub-tabs de setores */
        .sector-tabs {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #f0f0f0;
        }

        .sector-tab {
            padding: 8px 16px;
            background: #f0f0f0;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9em;
            color: #666;
            transition: all 0.3s;
        }

        .sector-tab:hover {
            background: #e0e0e0;
        }

        .sector-tab.active {
            background: #333;
            color: white;
        }

        /* Checklist container */
        .checklist-container {
            background: white;
            border-radius: 8px;
            padding: 20px;
        }

        .sector-title {
            font-size: 1.2em;
            font-weight: 600;
            color: #333;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #f0f0f0;
        }

        .checklist-item {
            border: 1px solid #f0f0f0;
            border-radius: 6px;
            padding: 15px;
            margin-bottom: 10px;
            background: white;
            transition: all 0.3s;
        }

        .checklist-item:hover {
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .checklist-item.nconforme {
            border-left: 4px solid #dc3545;
        }

        .checklist-item.conforme {
            border-left: 4px solid #28a745;
        }

        .item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .item-desc {
            font-weight: 500;
            color: #333;
        }

        .status-buttons {
            display: flex;
            gap: 10px;
        }

        .status-btn {
            padding: 6px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 500;
            font-size: 0.9em;
            transition: all 0.3s;
        }

        .btn-conforme {
            background: #28a745;
            color: white;
        }

        .btn-conforme.active {
            background: #218838;
            box-shadow: 0 0 0 2px rgba(40,167,69,0.3);
        }

        .btn-conforme:hover {
            background: #218838;
        }

        .btn-nconforme {
            background: #dc3545;
            color: white;
        }

        .btn-nconforme.active {
            background: #c82333;
            box-shadow: 0 0 0 2px rgba(220,53,69,0.3);
        }

        .btn-nconforme:hover {
            background: #c82333;
        }

        .observation-area {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-top: 10px;
            flex-wrap: wrap;
        }

        .observation-input {
            flex: 1;
            min-width: 200px;
            padding: 8px;
            border: 1px solid #e0e0e0;
            border-radius: 4px;
            font-size: 0.9em;
        }

        .photo-upload {
            position: relative;
        }

        .photo-btn {
            padding: 8px 15px;
            background: #f0f0f0;
            border: 1px solid #e0e0e0;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9em;
            color: #666;
            transition: all 0.3s;
        }

        .photo-btn:hover {
            background: #e0e0e0;
        }

        input[type="file"] {
            display: none;
        }

        .photo-preview {
            width: 80px;
            height: 80px;
            object-fit: cover;
            margin-top: 10px;
            border-radius: 4px;
            border: 1px solid #e0e0e0;
            cursor: pointer;
        }

        .photo-preview:hover {
            opacity: 0.8;
        }

        /* Se√ß√£o de Demandas de √Ågua */
        .agua-section {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .agua-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 15px;
        }

        .agua-card {
            background: #f8f8f8;
            padding: 15px;
            border-radius: 6px;
            text-align: center;
        }

        .agua-card h4 {
            color: #666;
            font-size: 0.9em;
            margin-bottom: 10px;
        }

        .agua-valor {
            font-size: 2em;
            font-weight: 600;
            color: #333;
        }

        .agua-label {
            color: #999;
            font-size: 0.8em;
            margin-top: 5px;
        }

        .comparativo-bars {
            display: flex;
            justify-content: center;
            align-items: flex-end;
            gap: 30px;
            height: 150px;
            margin-top: 20px;
        }

        .comparativo-bar {
            width: 60px;
            text-align: center;
        }

        .barra {
            width: 40px;
            background: #333;
            border-radius: 4px 4px 0 0;
            margin: 0 auto;
            transition: height 0.3s;
        }

        .barra.filial {
            background: #0066cc;
        }

        .barra.inspecao {
            background: #ff9933;
        }

        /* Se√ß√£o de conclus√£o */
        .conclusao-section {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .conclusao-section h3 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        .conclusao-section textarea {
            width: 100%;
            padding: 15px;
            border: 1px solid #e0e0e0;
            border-radius: 4px;
            font-size: 0.95em;
            min-height: 150px;
            resize: vertical;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        /* Bot√µes de exporta√ß√£o */
        .export-buttons {
            display: flex;
            gap: 15px;
            margin: 20px 0;
        }

        .btn-primary {
            flex: 1;
            padding: 15px;
            background: #333;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 600;
            font-size: 1.1em;
            transition: all 0.3s;
        }

        .btn-primary:hover {
            background: #555;
        }

        .btn-danger {
            background: #dc3545;
        }

        .btn-danger:hover {
            background: #c82333;
        }

        /* Estilos do relat√≥rio para exporta√ß√£o */
        .report-for-export {
            font-family: 'Segoe UI', Arial, sans-serif;
            max-width: 900px;
            margin: 0 auto;
            background: white;
            padding: 40px;
        }

        .report-header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid #333;
            padding-bottom: 20px;
        }

        .report-header h1 {
            color: #333;
            font-size: 2.2em;
        }

        .report-header h2 {
            color: #666;
            font-size: 1.4em;
            margin-top: 10px;
        }

        .report-date {
            color: #999;
            font-size: 0.9em;
            margin-top: 10px;
        }

        .report-section {
            margin: 30px 0;
        }

        .report-section-title {
            color: #333;
            font-size: 1.3em;
            font-weight: 600;
            margin-bottom: 15px;
            padding-bottom: 5px;
            border-bottom: 1px solid #ccc;
        }

        .report-subsection {
            margin: 20px 0;
        }

        .report-subsection-title {
            color: #666;
            font-size: 1.1em;
            font-weight: 500;
            margin-bottom: 10px;
        }

        .report-group {
            margin: 25px 0;
            padding: 15px;
            background: #f9f9f9;
            border-radius: 8px;
        }

        .report-group h3 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        .report-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }

        .report-table th {
            background: #f0f0f0;
            padding: 10px;
            text-align: left;
            font-weight: 600;
            color: #333;
        }

        .report-table td {
            padding: 8px 10px;
            border-bottom: 1px solid #e0e0e0;
        }

        .report-chart {
            margin: 20px 0;
            padding: 15px;
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
        }

        .report-photo-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .report-photo-item {
            text-align: center;
        }

        .report-photo-item img {
            width: 180px;
            height: 180px;
            object-fit: cover;
            border-radius: 8px;
            border: 1px solid #e0e0e0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .report-photo-caption {
            margin-top: 8px;
            font-size: 0.85em;
            color: #666;
        }

        .signature-area {
            margin-top: 50px;
            padding-top: 30px;
            border-top: 2px dashed #999;
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
        }

        .signature-line {
            text-align: center;
            min-width: 200px;
        }

        .signature-line p {
            margin-top: 40px;
            color: #666;
            border-top: 1px solid #999;
            padding-top: 5px;
        }
    </style>
    <!-- Bibliotecas -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="logo-area">
                <div class="logo-supermix">
                    SUPERMIX
                    <small>Concreto e Argamassa</small>
                </div>
                <div class="since">Desde 1976</div>
            </div>
            <div class="title-area">
                <h1>CHECK LIST - INSPE√á√ÉO DE FILIAL</h1>
                <p>Sistema de acompanhamento e gera√ß√£o de relat√≥rios t√©cnicos</p>
            </div>
        </div>

        <!-- Informa√ß√µes -->
        <div class="info-grid">
            <div class="info-item">
                <label>FILIAL</label>
                <input type="text" id="filial" placeholder="Nome da filial" value="Porto Velho">
            </div>
            <div class="info-item">
                <label>PER√çODO</label>
                <div style="display: flex; gap: 5px;">
                    <input type="date" id="periodoInicio" value="2026-02-02">
                    <span style="align-self: center;">A</span>
                    <input type="date" id="periodoFim" value="2026-02-06">
                </div>
            </div>
            <div class="info-item">
                <label>GERENTE</label>
                <input type="text" id="gerente" value="Jo√£o Silva">
            </div>
            <div class="info-item">
                <label>INSPETOR</label>
                <input type="text" id="inspetor" value="√çtalo Lima">
            </div>
            <div class="info-item">
                <label>SUPERVISOR</label>
                <input type="text" id="supervisor" value="Carlos Santos">
            </div>
        </div>

        <!-- Progresso -->
        <div class="progress-container">
            <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px;">
                <span class="stat"><strong id="totalItens">0</strong> Total de Itens</span>
                <span class="stat"><strong id="conformeCount">0</strong> ‚úì Conformes</span>
                <span class="stat"><strong id="nconformeCount">0</strong> ‚úó N√£o Conformes</span>
                <span class="stat"><strong id="pendenteCount">0</strong> ‚è≥ Pendentes</span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressBar"></div>
            </div>
        </div>

        <!-- Gr√°ficos Comparativos -->
        <div class="charts-grid">
            <!-- Gr√°fico de Conformidade por Grupo -->
            <div class="chart-card">
                <h3>Conformidade por Grupo</h3>
                <div class="chart-container">
                    <div class="bar-chart" id="grupoChart">
                        <!-- Gerado via JS -->
                    </div>
                </div>
                <div class="legend">
                    <div class="legend-item"><span class="legend-color" style="background:#28a745;"></span> Conforme</div>
                    <div class="legend-item"><span class="legend-color" style="background:#dc3545;"></span> N√£o Conforme</div>
                </div>
            </div>

            <!-- Gr√°fico de Demanda de √Ågua -->
            <div class="chart-card">
                <h3>Comparativo Demanda de √Ågua</h3>
                <div class="chart-container">
                    <div class="bar-chart" id="aguaChart">
                        <!-- Gerado via JS -->
                    </div>
                </div>
                <div class="legend">
                    <div class="legend-item"><span class="legend-color" style="background:#0066cc;"></span> Filial</div>
                    <div class="legend-item"><span class="legend-color" style="background:#ff9933;"></span> Inspe√ß√£o</div>
                </div>
            </div>

            <!-- Gr√°fico de Pizza - Geral -->
            <div class="chart-card">
                <h3>Vis√£o Geral</h3>
                <div class="pie-chart" id="pieChart"></div>
                <div class="legend">
                    <div class="legend-item"><span class="legend-color" style="background:#28a745;"></span> Conformes</div>
                    <div class="legend-item"><span class="legend-color" style="background:#dc3545;"></span> N√£o Conformes</div>
                </div>
            </div>
        </div>

        <!-- Se√ß√£o de Demanda de √Ågua (Detalhada) -->
        <div class="agua-section">
            <h3 style="margin-bottom: 15px;">üíß Demanda de √Ågua - Comparativo</h3>
            <div class="agua-grid">
                <div class="agua-card">
                    <h4>Procedimento</h4>
                    <div class="agua-valor" id="procedimentoStatus">‚úì Realizado</div>
                    <div class="agua-label">Filial realiza o procedimento</div>
                </div>
                <div class="agua-card">
                    <h4>Sobra M√©dia Filial</h4>
                    <div class="agua-valor" id="sobraFilial">145</div>
                    <div class="agua-label">litros/m¬≥</div>
                </div>
                <div class="agua-card">
                    <h4>Sobra M√©dia Inspe√ß√£o</h4>
                    <div class="agua-valor" id="sobraInspecao">132</div>
                    <div class="agua-label">litros/m¬≥</div>
                </div>
                <div class="agua-card">
                    <h4>Economia Potencial</h4>
                    <div class="agua-valor" id="economiaAgua">13</div>
                    <div class="agua-label">litros/m¬≥ (9%)</div>
                </div>
            </div>
            <div class="comparativo-bars">
                <div class="comparativo-bar">
                    <div class="barra filial" style="height: 145px;" id="barraFilial"></div>
                    <div style="margin-top: 8px;">Filial</div>
                </div>
                <div class="comparativo-bar">
                    <div class="barra inspecao" style="height: 132px;" id="barraInspecao"></div>
                    <div style="margin-top: 8px;">Inspe√ß√£o</div>
                </div>
            </div>
        </div>

        <!-- Navega√ß√£o por Grupos -->
        <div class="group-nav">
            <div class="group-tabs" id="groupTabs">
                <div class="group-tab active" data-group="maquinas" onclick="mudarGrupo('maquinas')">üè≠ M√ÅQUINAS/EQUIPAMENTOS</div>
                <div class="group-tab" data-group="laboratorio" onclick="mudarGrupo('laboratorio')">üî¨ LABORAT√ìRIO/MCC</div>
                <div class="group-tab" data-group="pessoas" onclick="mudarGrupo('pessoas')">üë• PESSOAS/EQUIPE</div>
            </div>
            <div class="group-content">
                <!-- Setores do grupo atual -->
                <div class="sector-tabs" id="sectorTabs"></div>
                <!-- Checklist -->
                <div class="checklist-container" id="checklistContainer"></div>
            </div>
        </div>

        <!-- A√ß√µes Realizadas -->
        <div style="background: white; border-radius: 8px; padding: 20px; margin: 20px 0; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
            <h3 style="margin-bottom: 15px;">üìã A√ß√µes Realizadas</h3>
            <div id="acoesContainer">
                <div class="checklist-item" style="display: flex; gap: 10px; align-items: center;">
                    <input type="text" class="observation-input" style="flex: 1;" value="Realiza√ß√£o do check list padr√£o de acompanhamento de central">
                    <button class="photo-btn" onclick="removerAcao(this)">‚úï</button>
                </div>
                <div class="checklist-item" style="display: flex; gap: 10px; align-items: center;">
                    <input type="text" class="observation-input" style="flex: 1;" value="Manuten√ß√£o da ret√≠fica">
                    <button class="photo-btn" onclick="removerAcao(this)">‚úï</button>
                </div>
                <div class="checklist-item" style="display: flex; gap: 10px; align-items: center;">
                    <input type="text" class="observation-input" style="flex: 1;" value="Realiza√ß√£o de aferi√ß√£o da prensa">
                    <button class="photo-btn" onclick="removerAcao(this)">‚úï</button>
                </div>
                <div class="checklist-item" style="display: flex; gap: 10px; align-items: center;">
                    <input type="text" class="observation-input" style="flex: 1;" value="Curva de inchamento">
                    <button class="photo-btn" onclick="removerAcao(this)">‚úï</button>
                </div>
                <div class="checklist-item" style="display: flex; gap: 10px; align-items: center;">
                    <input type="text" class="observation-input" style="flex: 1;" value="Teste com novo MCC">
                    <button class="photo-btn" onclick="removerAcao(this)">‚úï</button>
                </div>
            </div>
            <button class="btn-primary" style="margin-top: 10px;" onclick="adicionarAcao()">+ Adicionar A√ß√£o</button>
        </div>

        <!-- Conclus√£o Manual -->
        <div class="conclusao-section">
            <h3>üìù Conclus√£o do Relat√≥rio</h3>
            <textarea id="conclusaoManual" placeholder="Digite aqui a conclus√£o personalizada...">A unidade de Porto Velho n√£o apresenta resultados abaixo do fck. A visita teve como objetivo principal a identifica√ß√£o de oportunidades de melhoria nos processos, tendo sido observadas possibilidades de otimiza√ß√£o no desempenho da ret√≠fica, bem como a avalia√ß√£o de um novo MCC para o concreto. Apesar de, durante a visita de campo, ter sido identificado um abatimento (slump) fora do padr√£o especificado, a equipe de motoristas mostrou-se bem alinhada aos procedimentos operacionais. Destaca-se, ainda, o excelente trabalho desenvolvido pelos laboratoristas Ricardo e Adriano, que contribuem de forma significativa para a qualidade e confiabilidade dos resultados da unidade.</textarea>
        </div>

        <!-- Bot√µes Exporta√ß√£o -->
        <div class="export-buttons">
            <button class="btn-primary" onclick="gerarRelatorioWord()">üìÑ EXPORTAR PARA WORD</button>
            <button class="btn-primary btn-danger" onclick="gerarRelatorioPDF()">üìë EXPORTAR PARA PDF</button>
        </div>
    </div>

    <script>
        // Checklist completo
        const checklistData = {
            // M√ÅQUINAS/EQUIPAMENTOS
            "P√ÅTIO DE MATERIAIS": {
                grupo: "maquinas",
                itens: [
                    "AREIA NATURAL - CONDI√á√ÉO DE ESTOCAGEM",
                    "AREIA NATURAL - CONTAMINA√á√ïES",
                    "AREIA NATURAL - AMOSTRA PADR√ÉO - EXIST√äNCIA",
                    "ENSAIOS EXECUTADOS E LAN√áADOS NA INTRANET",
                    "AREIA ARTIFICIAL - CONDI√á√ÉO DE ESTOCAGEM",
                    "AREIA ARTIFICIAL - CONTAMINA√á√ïES",
                    "AREIA ARTIFICIAL - AMOSTRA PADR√ÉO - EXIST√äNCIA",
                    "ENSAIOS EXECUTADOS E LAN√áADOS NA INTRANET",
                    "BRITA 0 - CONDI√á√ÉO DE ESTOCAGEM",
                    "BRITA 0 - CONTAMINA√á√ïES",
                    "BRITA 0 - AMOSTRA PADR√ÉO - EXIST√äNCIA",
                    "BRITA 0 - ASPERSORES EFICIENTES",
                    "ENSAIOS EXECUTADOS E LAN√áADOS NA INTRANET",
                    "BRITA 1 - CONDI√á√ÉO DE ESTOCAGEM",
                    "BRITA 1 - CONTAMINA√á√ïES",
                    "BRITA 1 - AMOSTRA PADR√ÉO - EXIST√äNCIA",
                    "BRITA 1 - ASPERSORES EFICIENTES",
                    "ENSAIOS EXECUTADOS E LAN√áADOS NA INTRANET",
                    "ADITIVO - DIQUE DE CONTEN√á√ÉO",
                    "ADITIVO - TANQUES",
                    "ADITIVO - RECIRCULA√á√ÉO COM BOMBAS",
                    "ADITIVO - DENSIDADE NO RECEBIMENTO",
                    "ADITIVO - AMOSTRAS DE RETEN√á√ÉO",
                    "TAMBORES E CONTENTORES DO P√ÅTIO",
                    "SADA - DIQUE DE CONTEN√á√ÉO",
                    "SADA - TANQUES",
                    "SADA - RECIRCULA√á√ÉO COM BOMBAS",
                    "SADA - SISTEMA DE PESAGEM",
                    "SADA - DENSIDADE NO RECEBIMENTO",
                    "SADA - AMOSTRAS DE RETEN√á√ÉO",
                    "CIMENTO - SILOS IDENTIFICADOS",
                    "CIMENTO - AMOSTRAS DE RETEN√á√ÉO",
                    "CONDI√á√ÉO DA SILICA EM SACOS NO P√ÅTIO",
                    "CONDI√á√ÉO DOS INSUMOS DA ARGAMASSA",
                    "PRESEN√áA DE ADITIVOS EM TAMBORES/CONTENTORES"
                ]
            },
            "BATE LASTRO E RES√çDUOS": {
                grupo: "maquinas",
                itens: [
                    "PRESEN√áA DE ESPUMA",
                    "ENTUPIDO",
                    "RES√çDUOS ACUMULADOS",
                    "PRESEN√áA DE ADITIVOS",
                    "LIMPEZA GERAL DA CENTRAL"
                ]
            },
            "PONTO DE CARGA": {
                grupo: "maquinas",
                itens: [
                    "ENCLAUSURAMENTO",
                    "ASPERSORES",
                    "MATERIAL NO CH√ÉO",
                    "SAIA RASGADA"
                ]
            },
            "CENTRAL DOSADORA": {
                grupo: "maquinas",
                itens: [
                    "CAIXA DE AGREGADO - CONTAMINA√á√ÉO",
                    "CORREIAS TRANSPORTADORAS",
                    "BALAN√áA DE AGREGADOS - CONDI√á√ïES",
                    "BALAN√áA DE AGREGADOS - C√âLULA DE CARGA",
                    "BALAN√áA DE AGREGADOS - AFERI√á√ÉO",
                    "BALAN√áA DE CIMENTO - CONDI√á√ïES",
                    "BALAN√áA DE CIMENTO - C√âLULA DE CARGA",
                    "BALAN√áA DE CIMENTO - AFERI√á√ÉO",
                    "BALAN√áA DE CIMENTO - FILTRO",
                    "BALAN√áA DE CIMENTO - MANGOTE FLEX√çVEL",
                    "BALAN√áA DE ADITIVO - CONDI√á√ïES",
                    "BALAN√áA DE ADITIVO - C√âLULA DE CARGA",
                    "BALAN√áA DE ADITIVO - AFERI√á√ÉO",
                    "EXISTE ADITIVO DOSADO MANUAL"
                ]
            },
            "PESAGEM": {
                grupo: "maquinas",
                itens: [
                    "SEQU√äNCIA DE CARREGAMENTO CONCRETO",
                    "SEQU√äNCIA DE CARREGAMENTO ARGAMASSA",
                    "UMIDADE DAS AREIAS NO SISTEMA",
                    "SONDAS DE UMIDADE",
                    "VERIFICA√á√ÉO RELAT√ìRIOS DE AUTOMA√á√ÉO",
                    "CORTE DE √ÅGUA"
                ]
            },
            "CAMINH√ïES": {
                grupo: "maquinas",
                itens: [
                    "PRESEN√áA DE SLUMPMIX",
                    "FACAS",
                    "CONCRETO ADERIDO",
                    "HIDR√îMETRO",
                    "VELOCIDADE DO GIRO",
                    "KIT DE MOLDAGEM / SLUMP TEST",
                    "CAMINH√ÉO DE ARGAMASSA TRANSPORTANDO CONCRETO"
                ]
            },
            
            // LABORAT√ìRIO/MCC
            "LABORAT√ìRIO": {
                grupo: "laboratorio",
                itens: [
                    "CONDI√á√ïES DAS FORMAS PL√ÅSTICAS",
                    "DESFORMA - PRESS√ÉO DE AR",
                    "CONDI√á√ÉO CARRO COLETA",
                    "TEMPO M√âDIO DE COLETA",
                    "AVALIAR RELAT√ìRIO DE EXCLUS√ïES",
                    "CONDI√á√ÉO DO FRASCO DE CHAPMAN",
                    "CONDI√á√ÉO DAS PENEIRAS",
                    "TEMPERATURA DO TANQUE",
                    "FUNCIONAMENTO AQUECEDORES",
                    "RET√çFICA - CONDI√á√ïES",
                    "RET√çFICA - ESPESSURA DO CORTE",
                    "RET√çFICA - PRESS√ÉO DE AR",
                    "PRENSA - CONDI√á√ïES",
                    "PRENSA - AFERI√á√ÉO",
                    "PRENSA - VAZAMENTOS",
                    "PRENSA - PLANICIDADE DOS PRATOS",
                    "PRENSA - TESTE DO CARBANO"
                ]
            },
            "ARGAMASSA": {
                grupo: "laboratorio",
                itens: [
                    "AMOSTRA DE RETEN√á√ÉO ARGAMASSA",
                    "EXPEDI√á√ÉO - TEOR DE AR E SLUMP - REGISTROS",
                    "MOLDAGENS DE PRISMAS",
                    "MOLDAGENS DE PLACAS"
                ]
            },
            
            // PESSOAS/EQUIPE
            "EQUIPE": {
                grupo: "pessoas",
                itens: [
                    "TREINAMENTO MOTORISTAS",
                    "ATA DE REGISTRO",
                    "TREINAMENTO BALANCEIRO",
                    "ATA DE REGISTRO",
                    "VISITA SURPRESA",
                    "APLICA√á√ÉO DE ADVERT√äNCIAS"
                ]
            },
            "DEMANDA DE √ÅGUA": {
                grupo: "pessoas",
                itens: [
                    "FILIAL REALIZA O PROCEDIMENTO",
                    "SOBRA M√âDIA FILIAL",
                    "SOBRA M√âDIA INSPE√á√ÉO"
                ]
            }
        };

        // Estado da aplica√ß√£o
        let inspecao = {};
        let currentGrupo = 'maquinas';
        let currentSector = 'P√ÅTIO DE MATERIAIS';

        // Inicializar inspe√ß√£o
        function initInspecao() {
            for (let sector in checklistData) {
                inspecao[sector] = {};
                checklistData[sector].itens.forEach(item => {
                    // Valores padr√£o para demonstra√ß√£o
                    let status = null;
                    let observacao = '';
                    
                    // Simular alguns dados para exemplo
                    if (sector === 'P√ÅTIO DE MATERIAIS' && item.includes('CONTAMINA√á√ïES')) {
                        status = 'nconforme';
                        observacao = 'Presen√ßa de material org√¢nico';
                    } else if (sector === 'CAMINH√ïES' && item.includes('HIDR√îMETRO')) {
                        status = 'nconforme';
                        observacao = 'BT 1572 com diverg√™ncia';
                    } else if (sector === 'LABORAT√ìRIO' && item.includes('RET√çFICA')) {
                        status = 'nconforme';
                        observacao = 'Rolamento danificado';
                    } else {
                        status = 'conforme';
                    }
                    
                    inspecao[sector][item] = {
                        status: status,
                        observacao: observacao,
                        foto: null,
                        fotoNome: ''
                    };
                });
            }
            renderGroupTabs();
            renderSectorTabs();
            renderChecklist();
            updateProgress();
            atualizarGraficos();
        }

        // Renderizar abas de grupo
        function renderGroupTabs() {
            const tabs = document.querySelectorAll('.group-tab');
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    document.querySelectorAll('.group-tab').forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    currentGrupo = tab.dataset.group;
                    renderSectorTabs();
                });
            });
        }

        // Renderizar abas de setor baseado no grupo
        function renderSectorTabs() {
            const container = document.getElementById('sectorTabs');
            container.innerHTML = '';
            
            for (let sector in checklistData) {
                if (checklistData[sector].grupo === currentGrupo) {
                    const tab = document.createElement('span');
                    tab.className = `sector-tab ${sector === currentSector ? 'active' : ''}`;
                    tab.textContent = sector;
                    tab.onclick = () => {
                        currentSector = sector;
                        document.querySelectorAll('.sector-tab').forEach(t => t.classList.remove('active'));
                        tab.classList.add('active');
                        renderChecklist();
                    };
                    container.appendChild(tab);
                }
            }
            
            // Se n√£o houver setor atual no grupo, selecionar o primeiro
            const firstSector = Object.keys(checklistData).find(s => checklistData[s].grupo === currentGrupo);
            if (firstSector && !document.querySelector('.sector-tab.active')) {
                currentSector = firstSector;
                document.querySelectorAll('.sector-tab')[0]?.classList.add('active');
            }
            
            renderChecklist();
        }

        // Renderizar checklist
        function renderChecklist() {
            const container = document.getElementById('checklistContainer');
            if (!checklistData[currentSector]) return;
            
            const items = checklistData[currentSector].itens;
            
            let html = `<div class="sector-title">${currentSector}</div>`;
            
            items.forEach(item => {
                const itemData = inspecao[currentSector]?.[item] || { status: null, observacao: '', foto: null };
                const itemClass = itemData.status === 'conforme' ? 'conforme' : 
                                 itemData.status === 'nconforme' ? 'nconforme' : '';
                const itemId = `item-${currentSector}-${item.replace(/[^\w\s]/g, '').replace(/\s+/g, '-')}`;
                
                html += `
                    <div class="checklist-item ${itemClass}" id="${itemId}">
                        <div class="item-header">
                            <span class="item-desc">${item}</span>
                            <div class="status-buttons">
                                <button class="status-btn btn-conforme ${itemData.status === 'conforme' ? 'active' : ''}" 
                                        onclick="setStatus('${currentSector}', '${item.replace(/'/g, "\\'")}', 'conforme')">
                                    CONFORME
                                </button>
                                <button class="status-btn btn-nconforme ${itemData.status === 'nconforme' ? 'active' : ''}" 
                                        onclick="setStatus('${currentSector}', '${item.replace(/'/g, "\\'")}', 'nconforme')">
                                    N√ÉO CONFORME
                                </button>
                            </div>
                        </div>
                        <div class="observation-area">
                            <input type="text" class="observation-input" 
                                   placeholder="Observa√ß√£o..." 
                                   value="${itemData.observacao || ''}"
                                   onchange="setObservacao('${currentSector}', '${item.replace(/'/g, "\\'")}', this.value)">
                            <div class="photo-upload">
                                <label class="photo-btn" for="foto-${itemId}">
                                    üì∑ ANEXAR FOTO
                                </label>
                                <input type="file" id="foto-${itemId}" 
                                       accept="image/*" onchange="handlePhoto(event, '${currentSector}', '${item.replace(/'/g, "\\'")}')">
                            </div>
                        </div>
                        <div id="preview-${itemId}" style="display: flex; flex-wrap: wrap; gap: 10px; margin-top: 10px;">
                            ${itemData.foto ? `<img src="${itemData.foto}" class="photo-preview" onclick="window.open(this.src)">` : ''}
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        // Fun√ß√µes de manipula√ß√£o
        function setStatus(sector, item, status) {
            if (!inspecao[sector]) inspecao[sector] = {};
            if (!inspecao[sector][item]) inspecao[sector][item] = { status: null, observacao: '', foto: null };
            
            if (inspecao[sector][item].status === status) {
                inspecao[sector][item].status = null;
            } else {
                inspecao[sector][item].status = status;
            }
            updateProgress();
            atualizarGraficos();
            renderChecklist();
        }

        function setObservacao(sector, item, value) {
            if (!inspecao[sector]) inspecao[sector] = {};
            if (!inspecao[sector][item]) inspecao[sector][item] = { status: null, observacao: '', foto: null };
            inspecao[sector][item].observacao = value;
        }

        function handlePhoto(event, sector, item) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    if (!inspecao[sector]) inspecao[sector] = {};
                    if (!inspecao[sector][item]) inspecao[sector][item] = { status: null, observacao: '', foto: null };
                    inspecao[sector][item].foto = e.target.result;
                    inspecao[sector][item].fotoNome = file.name;
                    renderChecklist();
                };
                reader.readAsDataURL(file);
            }
        }

        function mudarGrupo(grupo) {
            currentGrupo = grupo;
            renderSectorTabs();
        }

        function adicionarAcao() {
            const container = document.getElementById('acoesContainer');
            const novaAcao = document.createElement('div');
            novaAcao.className = 'checklist-item';
            novaAcao.style.display = 'flex';
            novaAcao.style.gap = '10px';
            novaAcao.style.alignItems = 'center';
            novaAcao.innerHTML = `
                <input type="text" class="observation-input" style="flex: 1;" placeholder="Descreva a a√ß√£o realizada...">
                <button class="photo-btn" onclick="removerAcao(this)">‚úï</button>
            `;
            container.appendChild(novaAcao);
        }

        function removerAcao(btn) {
            btn.closest('.checklist-item').remove();
        }

        // Atualizar progresso
        function updateProgress() {
            let total = 0;
            let conforme = 0;
            let nconforme = 0;
            
            for (let sector in inspecao) {
                for (let item in inspecao[sector]) {
                    total++;
                    if (inspecao[sector][item]?.status === 'conforme') conforme++;
                    if (inspecao[sector][item]?.status === 'nconforme') nconforme++;
                }
            }
            
            const pendente = total - conforme - nconforme;
            const progresso = ((conforme + nconforme) / total) * 100;
            
            document.getElementById('totalItens').textContent = total;
            document.getElementById('conformeCount').textContent = conforme;
            document.getElementById('nconformeCount').textContent = nconforme;
            document.getElementById('pendenteCount').textContent = pendente;
            document.getElementById('progressBar').style.width = progresso + '%';
            
            // Atualizar gr√°fico de pizza
            const percentConforme = (conforme / total) * 100;
            document.getElementById('pieChart').style.background = 
                `conic-gradient(#28a745 0% ${percentConforme}%, #dc3545 ${percentConforme}% 100%)`;
        }

        // Atualizar gr√°ficos
        function atualizarGraficos() {
            // Gr√°fico por grupo
            const grupos = {
                maquinas: { conforme: 0, total: 0 },
                laboratorio: { conforme: 0, total: 0 },
                pessoas: { conforme: 0, total: 0 }
            };
            
            for (let sector in inspecao) {
                const grupo = checklistData[sector]?.grupo;
                if (grupo) {
                    for (let item in inspecao[sector]) {
                        grupos[grupo].total++;
                        if (inspecao[sector][item]?.status === 'conforme') {
                            grupos[grupo].conforme++;
                        }
                    }
                }
            }
            
            // Renderizar gr√°fico de barras por grupo
            const grupoChart = document.getElementById('grupoChart');
            grupoChart.innerHTML = '';
            
            for (let grupo in grupos) {
                const total = grupos[grupo].total;
                const conforme = grupos[grupo].conforme;
                const percentual = total > 0 ? (conforme / total) * 100 : 0;
                
                const barItem = document.createElement('div');
                barItem.className = 'bar-item';
                barItem.innerHTML = `
                    <div class="bar-value">${conforme}/${total}</div>
                    <div class="bar" style="height: ${percentual}px; background: #28a745;"></div>
                    <div class="bar-label">${grupo === 'maquinas' ? 'M√°quinas' : grupo === 'laboratorio' ? 'Lab' : 'Pessoas'}</div>
                `;
                grupoChart.appendChild(barItem);
            }
            
            // Atualizar valores de √°gua
            const sobraFilial = document.getElementById('sobraFilial')?.value || '145';
            const sobraInspecao = document.getElementById('sobraInspecao')?.value || '132';
            
            document.getElementById('sobraFilial').textContent = sobraFilial;
            document.getElementById('sobraInspecao').textContent = sobraInspecao;
            
            const economia = sobraFilial - sobraInspecao;
            document.getElementById('economiaAgua').textContent = economia;
            
            document.getElementById('barraFilial').style.height = sobraFilial + 'px';
            document.getElementById('barraInspecao').style.height = sobraInspecao + 'px';
            
            // Gr√°fico de √°gua
            const aguaChart = document.getElementById('aguaChart');
            aguaChart.innerHTML = '';
            
            const barFilial = document.createElement('div');
            barFilial.className = 'bar-item';
            barFilial.innerHTML = `
                <div class="bar-value">${sobraFilial}</div>
                <div class="bar" style="height: ${sobraFilial}px; background: #0066cc;"></div>
                <div class="bar-label">Filial</div>
            `;
            
            const barInspecao = document.createElement('div');
            barInspecao.className = 'bar-item';
            barInspecao.innerHTML = `
                <div class="bar-value">${sobraInspecao}</div>
                <div class="bar" style="height: ${sobraInspecao}px; background: #ff9933;"></div>
                <div class="bar-label">Inspe√ß√£o</div>
            `;
            
            aguaChart.appendChild(barFilial);
            aguaChart.appendChild(barInspecao);
        }

        // Gerar relat√≥rio Word
        function gerarRelatorioWord() {
            const filial = document.getElementById('filial').value || 'N√ÉO INFORMADO';
            const periodoInicio = document.getElementById('periodoInicio').value || '____';
            const periodoFim = document.getElementById('periodoFim').value || '____';
            const gerente = document.getElementById('gerente').value || 'N√ÉO INFORMADO';
            const inspetor = document.getElementById('inspetor').value || 'N√ÉO INFORMADO';
            const supervisor = document.getElementById('supervisor').value || 'N√ÉO INFORMADO';
            const conclusaoManual = document.getElementById('conclusaoManual').value || '';
            
            const dataAtual = new Date().toLocaleDateString('pt-BR');
            const cidade = filial.split(' ')[0] || 'Filial';
            
            // Coletar a√ß√µes
            const acoes = [];
            document.querySelectorAll('#acoesContainer .checklist-item input').forEach(input => {
                if (input.value.trim()) {
                    acoes.push(input.value.trim());
                }
            });
            
            // Coletar itens por grupo
            const grupos = {
                maquinas: { titulo: 'M√ÅQUINAS E EQUIPAMENTOS', itens: [], fotos: [] },
                laboratorio: { titulo: 'LABORAT√ìRIO E MCC', itens: [], fotos: [] },
                pessoas: { titulo: 'PESSOAS E EQUIPE', itens: [], fotos: [] }
            };
            
            for (let sector in inspecao) {
                const grupo = checklistData[sector]?.grupo;
                if (grupo) {
                    for (let item in inspecao[sector]) {
                        if (inspecao[sector][item]?.status === 'nconforme') {
                            grupos[grupo].itens.push({
                                setor: sector,
                                item: item,
                                obs: inspecao[sector][item].observacao || 'Sem observa√ß√µes'
                            });
                        }
                        if (inspecao[sector][item]?.foto) {
                            grupos[grupo].fotos.push({
                                setor: sector,
                                item: item,
                                foto: inspecao[sector][item].foto,
                                obs: inspecao[sector][item].observacao
                            });
                        }
                    }
                }
            }
            
            // Valores de √°gua
            const sobraFilial = document.getElementById('sobraFilial').textContent || '145';
            const sobraInspecao = document.getElementById('sobraInspecao').textContent || '132';
            
            // Gerar HTML
            let reportHTML = `
                <html>
                <head>
                    <meta charset="UTF-8">
                    <title>Relat√≥rio de Inspe√ß√£o - ${filial}</title>
                    <style>
                        body { font-family: 'Segoe UI', Arial, sans-serif; max-width: 900px; margin: 0 auto; padding: 40px; }
                        h1 { color: #333; text-align: center; font-size: 2.2em; }
                        h2 { color: #666; border-bottom: 2px solid #333; padding-bottom: 5px; }
                        h3 { color: #333; margin: 20px 0 10px; }
                        h4 { color: #666; margin: 15px 0 5px; }
                        .header { text-align: center; margin-bottom: 30px; border-bottom: 2px solid #333; padding-bottom: 20px; }
                        .date { color: #999; font-size: 0.9em; margin-top: 10px; }
                        .section { margin: 30px 0; }
                        .subsection { margin: 20px 0; }
                        .group-box { margin: 25px 0; padding: 15px; background: #f9f9f9; border-radius: 8px; border-left: 4px solid #333; }
                        table { width: 100%; border-collapse: collapse; margin: 15px 0; }
                        th { background: #f0f0f0; padding: 10px; text-align: left; }
                        td { padding: 8px 10px; border-bottom: 1px solid #e0e0e0; }
                        .photo-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 20px; margin: 20px 0; }
                        .photo-item { text-align: center; }
                        .photo-item img { width: 180px; height: 180px; object-fit: cover; border-radius: 8px; border: 1px solid #ccc; }
                        .photo-caption { margin-top: 5px; font-size: 0.85em; color: #666; }
                        .signature { margin-top: 50px; display: flex; justify-content: space-around; }
                        .signature-line { text-align: center; min-width: 200px; }
                        .signature-line p { margin-top: 40px; border-top: 1px solid #999; padding-top: 5px; }
                    </style>
                </head>
                <body>
                    <div class="header">
                        <h1>SUPERMIX</h1>
                        <p>Concreto e Argamassa ‚Ä¢ Desde 1976</p>
                        <h2>RELAT√ìRIO T√âCNICO DE INSPE√á√ÉO DE FILIAL</h2>
                        <p class="date">${cidade}, ${dataAtual}</p>
                    </div>
                    
                    <div class="section">
                        <h3>1. Per√≠odo da Visita / Filial / T√©cnico Respons√°vel</h3>
                        <p>Visita realizada no per√≠odo de ${periodoInicio} a ${periodoFim} na filial <strong>${filial}</strong> pelo tecnologista <strong>${inspetor}</strong>.</p>
                    </div>
                    
                    <div class="section">
                        <h3>2. A√ß√µes Realizadas</h3>
                        <ul>
                            ${acoes.map(acao => `<li>‚Ä¢ ${acao}</li>`).join('')}
                        </ul>
                    </div>
                    
                    <div class="section">
                        <h3>3. An√°lise por Grupos</h3>
                        
                        <!-- GRUPO 1: M√ÅQUINAS E EQUIPAMENTOS -->
                        <div class="group-box">
                            <h4>3.1 M√ÅQUINAS E EQUIPAMENTOS</h4>
                            ${grupos.maquinas.itens.length > 0 ? `
                                <table>
                                    <tr><th>Item</th><th>Observa√ß√£o</th></tr>
                                    ${grupos.maquinas.itens.map(item => `
                                        <tr><td><strong>${item.setor}:</strong> ${item.item}</td><td>${item.obs}</td></tr>
                                    `).join('')}
                                </table>
                            ` : '<p>Nenhuma n√£o conformidade identificada neste grupo.</p>'}
                            
                            ${grupos.maquinas.fotos.length > 0 ? `
                                <div class="photo-grid">
                                    ${grupos.maquinas.fotos.map((foto, idx) => `
                                        <div class="photo-item">
                                            <img src="${foto.foto}" alt="Foto">
                                            <div class="photo-caption">${foto.setor}: ${foto.item}</div>
                                        </div>
                                    `).join('')}
                                </div>
                            ` : ''}
                        </div>
                        
                        <!-- GRUPO 2: LABORAT√ìRIO E MCC -->
                        <div class="group-box">
                            <h4>3.2 LABORAT√ìRIO E MCC</h4>
                            ${grupos.laboratorio.itens.length > 0 ? `
                                <table>
                                    <tr><th>Item</th><th>Observa√ß√£o</th></tr>
                                    ${grupos.laboratorio.itens.map(item => `
                                        <tr><td><strong>${item.setor}:</strong> ${item.item}</td><td>${item.obs}</td></tr>
                                    `).join('')}
                                </table>
                            ` : '<p>Nenhuma n√£o conformidade identificada neste grupo.</p>'}
                            
                            ${grupos.laboratorio.fotos.length > 0 ? `
                                <div class="photo-grid">
                                    ${grupos.laboratorio.fotos.map((foto, idx) => `
                                        <div class="photo-item">
                                            <img src="${foto.foto}" alt="Foto">
                                            <div class="photo-caption">${foto.setor}: ${foto.item}</div>
                                        </div>
                                    `).join('')}
                                </div>
                            ` : ''}
                        </div>
                        
                        <!-- GRUPO 3: PESSOAS E EQUIPE -->
                        <div class="group-box">
                            <h4>3.3 PESSOAS E EQUIPE</h4>
                            ${grupos.pessoas.itens.length > 0 ? `
                                <table>
                                    <tr><th>Item</th><th>Observa√ß√£o</th></tr>
                                    ${grupos.pessoas.itens.map(item => `
                                        <tr><td><strong>${item.setor}:</strong> ${item.item}</td><td>${item.obs}</td></tr>
                                    `).join('')}
                                </table>
                            ` : '<p>Nenhuma n√£o conformidade identificada neste grupo.</p>'}
                            
                            ${grupos.pessoas.fotos.length > 0 ? `
                                <div class="photo-grid">
                                    ${grupos.pessoas.fotos.map((foto, idx) => `
                                        <div class="photo-item">
                                            <img src="${foto.foto}" alt="Foto">
                                            <div class="photo-caption">${foto.setor}: ${foto.item}</div>
                                        </div>
                                    `).join('')}
                                </div>
                            ` : ''}
                        </div>
                    </div>
                    
                    <div class="section">
                        <h3>4. An√°lise Comparativa - Demanda de √Ågua</h3>
                        <table>
                            <tr><th>Indicador</th><th>Valor</th></tr>
                            <tr><td>Sobra M√©dia da Filial</td><td><strong>${sobraFilial} L/m¬≥</strong></td></tr>
                            <tr><td>Sobra M√©dia na Inspe√ß√£o</td><td><strong>${sobraInspecao} L/m¬≥</strong></td></tr>
                            <tr><td>Economia Potencial</td><td><strong>${sobraFilial - sobraInspecao} L/m¬≥ (${Math.round((sobraFilial - sobraInspecao)/sobraFilial*100)}%)</strong></td></tr>
                        </table>
                    </div>
                    
                    <div class="section">
                        <h3>5. Conclus√£o</h3>
                        <p>${conclusaoManual || 'A unidade n√£o apresenta resultados abaixo do fck. A visita teve como objetivo principal a identifica√ß√£o de oportunidades de melhoria nos processos.'}</p>
                    </div>
                    
                    <div class="signature">
                        <div class="signature-line">
                            ______________________________
                            <p>${inspetor}<br>Respons√°vel pela Inspe√ß√£o</p>
                        </div>
                        <div class="signature-line">
                            ______________________________
                            <p>${gerente}<br>Gerente da Filial</p>
                        </div>
                        <div class="signature-line">
                            ______________________________
                            <p>${supervisor}<br>Supervisor Respons√°vel</p>
                        </div>
                    </div>
                </body>
                </html>
            `;
            
            // Criar e baixar arquivo Word
            const blob = new Blob([reportHTML], { type: 'application/msword' });
            saveAs(blob, `Relatorio_${filial}_${dataAtual.replace(/\//g, '-')}.doc`);
        }

        function gerarRelatorioPDF() {
            alert('Para melhor formata√ß√£o e qualidade das imagens, utilize a exporta√ß√£o para Word e depois salve como PDF.');
        }

        // Inicializar
        initInspecao();
        
        // Atualizar valores de √°gua
        setInterval(atualizarGraficos, 1000);
    </script>
</body>
</html>