<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SUPERMIX - Sistema de Inspe√ß√£o</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: #f5f5f5;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        /* Header com logo SUPERMIX */
        .header {
            background: #333333;
            padding: 20px 30px;
            border-radius: 10px;
            margin-bottom: 25px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            position: relative;
            overflow: hidden;
        }

        .logo-container {
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 20px;
        }

        .logo-left {
            display: flex;
            align-items: baseline;
            gap: 15px;
        }

        .logo-number {
            font-size: 4em;
            font-weight: 800;
            color: #C41E3A;
            line-height: 1;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .logo-since {
            font-size: 1.2em;
            color: #C41E3A;
            font-weight: 500;
        }

        .logo-supermix {
            text-align: right;
        }

        .logo-supermix h1 {
            font-size: 3.5em;
            font-weight: 800;
            color: white;
            letter-spacing: 2px;
            line-height: 1;
        }

        .logo-supermix h2 {
            font-size: 1.3em;
            font-weight: 400;
            color: #C41E3A;
            letter-spacing: 1px;
            margin-top: 5px;
        }

        .logo-footer {
            font-size: 0.9em;
            color: #999;
            margin-top: 5px;
            font-style: italic;
        }

        /* Grid de informa√ß√µes - CORRIGIDO */
        .info-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 15px;
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .info-item {
            display: flex;
            flex-direction: column;
        }

        .info-item label {
            font-size: 0.8em;
            color: #C41E3A;
            margin-bottom: 5px;
            text-transform: uppercase;
            font-weight: 600;
        }

        .info-item input {
            padding: 10px;
            border: 1px solid #e0e0e0;
            border-radius: 4px;
            font-size: 0.95em;
            transition: all 0.3s;
            width: 100%;
        }

        .info-item input:focus {
            outline: none;
            border-color: #C41E3A;
            box-shadow: 0 0 5px rgba(196,30,58,0.2);
        }

        .periodo-group {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .periodo-group input {
            flex: 1;
            min-width: 0;
        }

        .periodo-group span {
            color: #333;
            font-weight: 600;
            white-space: nowrap;
        }

        /* Responsividade do grid */
        @media (max-width: 1200px) {
            .info-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        @media (max-width: 768px) {
            .info-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 480px) {
            .info-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Barra de progresso */
        .progress-container {
            background: white;
            padding: 15px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border-top: 3px solid #C41E3A;
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 10px;
        }

        .stats {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }

        .stat {
            font-size: 0.95em;
            color: #666;
        }

        .stat strong {
            color: #C41E3A;
            font-size: 1.3em;
            margin-right: 5px;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #f0f0f0;
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #C41E3A, #8B0000);
            transition: width 0.3s ease;
            width: 0%;
        }

        /* Cards de gr√°ficos */
        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .chart-card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border-bottom: 3px solid #C41E3A;
        }

        .chart-card h3 {
            color: #333;
            font-size: 1.1em;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #f0f0f0;
        }

        .chart-container {
            height: 200px;
            position: relative;
        }

        .bar-chart {
            display: flex;
            align-items: flex-end;
            height: 150px;
            gap: 20px;
            justify-content: center;
        }

        .bar-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 70px;
        }

        .bar {
            width: 40px;
            border-radius: 4px 4px 0 0;
            transition: height 0.3s;
            min-height: 5px;
            background: #C41E3A;
        }

        .bar-label {
            margin-top: 8px;
            font-size: 0.85em;
            color: #666;
            text-align: center;
            font-weight: 500;
        }

        .bar-value {
            font-size: 0.8em;
            color: #999;
            margin-bottom: 5px;
        }

        .pie-chart {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            margin: 0 auto;
            background: conic-gradient(#C41E3A 0% 75%, #666 75% 100%);
        }

        .legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 15px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.85em;
        }

        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 3px;
        }

        /* Navega√ß√£o por grupos */
        .group-nav {
            background: white;
            border-radius: 8px;
            margin: 20px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .group-tabs {
            display: flex;
            background: #f8f8f8;
            border-bottom: 1px solid #e0e0e0;
        }

        .group-tab {
            flex: 1;
            padding: 15px;
            cursor: pointer;
            color: #666;
            font-weight: 600;
            text-align: center;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
        }

        .group-tab:hover {
            color: #C41E3A;
            background: #f0f0f0;
        }

        .group-tab.active {
            color: #C41E3A;
            border-bottom-color: #C41E3A;
            background: white;
        }

        .group-content {
            padding: 20px;
        }

        /* Sub-tabs de setores */
        .sector-tabs {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #f0f0f0;
        }

        .sector-tab {
            padding: 8px 16px;
            background: #f0f0f0;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9em;
            color: #666;
            transition: all 0.3s;
            font-weight: 500;
        }

        .sector-tab:hover {
            background: #e0e0e0;
            color: #C41E3A;
        }

        .sector-tab.active {
            background: #C41E3A;
            color: white;
        }

        /* Checklist container */
        .checklist-container {
            background: white;
            border-radius: 8px;
        }

        .sector-title {
            font-size: 1.2em;
            font-weight: 600;
            color: #C41E3A;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #f0f0f0;
        }

        .checklist-item {
            border: 1px solid #f0f0f0;
            border-radius: 6px;
            padding: 15px;
            margin-bottom: 10px;
            background: white;
            transition: all 0.3s;
        }

        .checklist-item:hover {
            box-shadow: 0 2px 8px rgba(196,30,58,0.1);
        }

        .checklist-item.nconforme {
            border-left: 4px solid #C41E3A;
        }

        .checklist-item.conforme {
            border-left: 4px solid #28a745;
        }

        .item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .item-desc {
            font-weight: 600;
            color: #333;
            font-size: 1em;
        }

        .status-buttons {
            display: flex;
            gap: 10px;
        }

        .status-btn {
            padding: 6px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.9em;
            transition: all 0.3s;
        }

        .btn-conforme {
            background: #28a745;
            color: white;
        }

        .btn-conforme.active {
            background: #218838;
            box-shadow: 0 0 0 2px rgba(40,167,69,0.3);
        }

        .btn-nconforme {
            background: #C41E3A;
            color: white;
        }

        .btn-nconforme.active {
            background: #8B0000;
            box-shadow: 0 0 0 2px rgba(196,30,58,0.3);
        }

        .observation-area {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-top: 10px;
            flex-wrap: wrap;
        }

        .observation-input {
            flex: 1;
            min-width: 200px;
            padding: 8px 12px;
            border: 1px solid #e0e0e0;
            border-radius: 4px;
            font-size: 0.95em;
        }

        .photo-upload {
            position: relative;
        }

        .photo-btn {
            padding: 8px 15px;
            background: #f0f0f0;
            border: 1px solid #e0e0e0;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9em;
            color: #666;
            transition: all 0.3s;
        }

        .photo-btn:hover {
            background: #C41E3A;
            color: white;
            border-color: #C41E3A;
        }

        input[type="file"] {
            display: none;
        }

        .photo-preview {
            width: 80px;
            height: 80px;
            object-fit: cover;
            margin-top: 10px;
            border-radius: 4px;
            border: 2px solid #f0f0f0;
            cursor: pointer;
            transition: all 0.3s;
        }

        .photo-preview:hover {
            transform: scale(1.05);
            border-color: #C41E3A;
        }

        /* Se√ß√£o de Demanda de √Ågua */
        .agua-section {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border-top: 3px solid #C41E3A;
        }

        .agua-section h3 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.2em;
        }

        .agua-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .agua-card {
            background: #f8f8f8;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            border-bottom: 3px solid #C41E3A;
        }

        .agua-card h4 {
            color: #666;
            font-size: 0.9em;
            margin-bottom: 10px;
            text-transform: uppercase;
        }

        .agua-valor {
            font-size: 2.5em;
            font-weight: 700;
            color: #C41E3A;
        }

        .agua-label {
            color: #999;
            font-size: 0.85em;
            margin-top: 5px;
        }

        .comparativo-bars {
            display: flex;
            justify-content: center;
            align-items: flex-end;
            gap: 40px;
            height: 180px;
            margin-top: 20px;
        }

        .comparativo-bar {
            width: 80px;
            text-align: center;
        }

        .barra {
            width: 50px;
            border-radius: 6px 6px 0 0;
            margin: 0 auto;
            transition: height 0.3s;
        }

        .barra.filial {
            background: #333;
        }

        .barra.inspecao {
            background: #C41E3A;
        }

        .barra-label {
            margin-top: 10px;
            font-weight: 600;
            color: #666;
        }

        .barra-value {
            font-size: 0.9em;
            color: #999;
            margin-bottom: 5px;
        }

        /* Se√ß√£o de a√ß√µes */
        .acoes-section {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border-top: 3px solid #C41E3A;
        }

        .acoes-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .acoes-header h3 {
            color: #333;
            font-size: 1.2em;
        }

        .btn-add {
            padding: 8px 20px;
            background: #C41E3A;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
        }

        .btn-add:hover {
            background: #8B0000;
        }

        .acao-item {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-bottom: 10px;
        }

        .acao-item input {
            flex: 1;
            padding: 10px;
            border: 1px solid #e0e0e0;
            border-radius: 4px;
        }

        .btn-remove {
            padding: 8px 12px;
            background: #f0f0f0;
            border: 1px solid #e0e0e0;
            border-radius: 4px;
            cursor: pointer;
            color: #C41E3A;
            transition: all 0.3s;
        }

        .btn-remove:hover {
            background: #C41E3A;
            color: white;
            border-color: #C41E3A;
        }

        /* Se√ß√£o de conclus√£o */
        .conclusao-section {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border-top: 3px solid #C41E3A;
        }

        .conclusao-section h3 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        .conclusao-section textarea {
            width: 100%;
            padding: 15px;
            border: 2px solid #f0f0f0;
            border-radius: 8px;
            font-size: 1em;
            min-height: 150px;
            resize: vertical;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            transition: all 0.3s;
        }

        .conclusao-section textarea:focus {
            outline: none;
            border-color: #C41E3A;
        }

        /* Bot√µes de exporta√ß√£o */
        .export-buttons {
            display: flex;
            gap: 15px;
            margin: 20px 0;
        }

        .btn-primary {
            flex: 1;
            padding: 15px;
            background: #333;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 1.1em;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .btn-primary:hover {
            background: #C41E3A;
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(196,30,58,0.3);
        }

        .btn-danger {
            background: #C41E3A;
        }

        .btn-danger:hover {
            background: #8B0000;
        }

        /* Estilos do relat√≥rio para exporta√ß√£o */
        .report-for-export {
            font-family: 'Segoe UI', Arial, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            padding: 40px;
        }

        .report-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 3px solid #C41E3A;
        }

        .report-header h1 {
            color: #333;
            font-size: 2.5em;
            margin-bottom: 5px;
        }

        .report-header h2 {
            color: #C41E3A;
            font-size: 1.3em;
            font-weight: 400;
            margin-bottom: 5px;
        }

        .report-header .slogan {
            color: #666;
            font-style: italic;
            margin-top: 10px;
        }

        .report-info {
            background: #f8f8f8;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
        }

        .report-group-box {
            margin: 30px 0;
            padding: 20px;
            background: #f8f8f8;
            border-radius: 10px;
            border-left: 4px solid #C41E3A;
        }

        .report-group-title {
            color: #333;
            font-size: 1.4em;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .report-chart-box {
            margin: 20px 0;
            padding: 20px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .report-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }

        .report-table th {
            background: #333;
            color: white;
            padding: 10px;
            text-align: left;
        }

        .report-table td {
            padding: 8px 10px;
            border-bottom: 1px solid #e0e0e0;
        }

        .report-photo-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .report-photo-item {
            text-align: center;
            background: white;
            padding: 10px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .report-photo-item img {
            width: 160px;
            height: 160px;
            object-fit: cover;
            border-radius: 8px;
            border: 2px solid #f0f0f0;
        }

        .report-photo-caption {
            margin-top: 8px;
            font-size: 0.85em;
            color: #666;
        }

        .signature-area {
            margin-top: 50px;
            padding-top: 30px;
            border-top: 2px dashed #999;
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 30px;
        }

        .signature-line {
            text-align: center;
            min-width: 200px;
        }

        .signature-line p {
            margin-top: 40px;
            color: #666;
            border-top: 2px solid #C41E3A;
            padding-top: 5px;
        }
    </style>
    <!-- Bibliotecas -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
</head>
<body>
    <div class="container">
        <!-- Header com logo SUPERMIX (cinza e vermelho) -->
        <div class="header">
            <div class="logo-container">
                <div class="logo-left">
                    <span class="logo-number">50</span>
                    <span class="logo-since">Desde 1976</span>
                </div>
                <div class="logo-supermix">
                    <h1>SUPERMIX</h1>
                    <h2>facilitando a constru√ß√£o civil</h2>
                    <div class="logo-footer">ORGULHO DE FAZER PARTE DESTA HIST√ìRIA.</div>
                </div>
            </div>
        </div>

        <!-- Informa√ß√µes - GRID CORRIGIDO -->
        <div class="info-grid">
            <div class="info-item">
                <label>FILIAL</label>
                <input type="text" id="filial" placeholder="Nome da filial" value="Porto Velho">
            </div>
            <div class="info-item">
                <label>PER√çODO</label>
                <div class="periodo-group">
                    <input type="date" id="periodoInicio" value="2026-02-02">
                    <span>A</span>
                    <input type="date" id="periodoFim" value="2026-02-06">
                </div>
            </div>
            <div class="info-item">
                <label>GERENTE</label>
                <input type="text" id="gerente" value="Jo√£o Silva">
            </div>
            <div class="info-item">
                <label>INSPETOR</label>
                <input type="text" id="inspetor" value="√çtalo Lima">
            </div>
            <div class="info-item">
                <label>SUPERVISOR</label>
                <input type="text" id="supervisor" value="Carlos Santos">
            </div>
        </div>

        <!-- Progresso -->
        <div class="progress-container">
            <div class="progress-header">
                <span class="stat"><strong id="totalItens">0</strong> Total de Itens</span>
                <div class="stats">
                    <span class="stat"><strong id="conformeCount">0</strong> ‚úì Conformes</span>
                    <span class="stat"><strong id="nconformeCount">0</strong> ‚úó N√£o Conformes</span>
                    <span class="stat"><strong id="pendenteCount">0</strong> ‚è≥ Pendentes</span>
                </div>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressBar"></div>
            </div>
        </div>

        <!-- Gr√°ficos Comparativos -->
        <div class="charts-grid">
            <div class="chart-card">
                <h3>Conformidade por Grupo</h3>
                <div class="chart-container">
                    <div class="bar-chart" id="grupoChart"></div>
                </div>
                <div class="legend">
                    <div class="legend-item"><span class="legend-color" style="background:#C41E3A;"></span> Conforme</div>
                    <div class="legend-item"><span class="legend-color" style="background:#666;"></span> N√£o Conforme</div>
                </div>
            </div>
            <div class="chart-card">
                <h3>Comparativo Demanda de √Ågua</h3>
                <div class="chart-container">
                    <div class="bar-chart" id="aguaChart"></div>
                </div>
                <div class="legend">
                    <div class="legend-item"><span class="legend-color" style="background:#333;"></span> Filial</div>
                    <div class="legend-item"><span class="legend-color" style="background:#C41E3A;"></span> Inspe√ß√£o</div>
                </div>
            </div>
            <div class="chart-card">
                <h3>Vis√£o Geral da Inspe√ß√£o</h3>
                <div class="pie-chart" id="pieChart"></div>
                <div class="legend">
                    <div class="legend-item"><span class="legend-color" style="background:#C41E3A;"></span> Conformes</div>
                    <div class="legend-item"><span class="legend-color" style="background:#666;"></span> N√£o Conformes</div>
                </div>
            </div>
        </div>

        <!-- Se√ß√£o de Demanda de √Ågua -->
        <div class="agua-section">
            <h3>üíß Demanda de √Ågua - Comparativo</h3>
            <div class="agua-grid">
                <div class="agua-card">
                    <h4>Procedimento</h4>
                    <div class="agua-valor" id="procedimentoStatus">‚úì</div>
                    <div class="agua-label">Filial realiza</div>
                </div>
                <div class="agua-card">
                    <h4>Sobra M√©dia Filial</h4>
                    <div class="agua-valor" id="sobraFilial">145</div>
                    <div class="agua-label">litros/m¬≥</div>
                </div>
                <div class="agua-card">
                    <h4>Sobra M√©dia Inspe√ß√£o</h4>
                    <div class="agua-valor" id="sobraInspecao">132</div>
                    <div class="agua-label">litros/m¬≥</div>
                </div>
                <div class="agua-card">
                    <h4>Economia Potencial</h4>
                    <div class="agua-valor" id="economiaAgua">13</div>
                    <div class="agua-label">litros/m¬≥ (9%)</div>
                </div>
            </div>
            <div class="comparativo-bars">
                <div class="comparativo-bar">
                    <div class="barra-value" id="valorFilial">145 L</div>
                    <div class="barra filial" style="height: 145px;" id="barraFilial"></div>
                    <div class="barra-label">Filial</div>
                </div>
                <div class="comparativo-bar">
                    <div class="barra-value" id="valorInspecao">132 L</div>
                    <div class="barra inspecao" style="height: 132px;" id="barraInspecao"></div>
                    <div class="barra-label">Inspe√ß√£o</div>
                </div>
            </div>
        </div>

        <!-- Navega√ß√£o por Grupos -->
        <div class="group-nav">
            <div class="group-tabs">
                <div class="group-tab active" onclick="mudarGrupo('maquinas', this)">üè≠ M√ÅQUINAS/EQUIPAMENTOS</div>
                <div class="group-tab" onclick="mudarGrupo('laboratorio', this)">üî¨ LABORAT√ìRIO/MCC</div>
                <div class="group-tab" onclick="mudarGrupo('pessoas', this)">üë• PESSOAS/EQUIPE</div>
            </div>
            <div class="group-content">
                <div class="sector-tabs" id="sectorTabs"></div>
                <div class="checklist-container" id="checklistContainer"></div>
            </div>
        </div>

        <!-- A√ß√µes Realizadas -->
        <div class="acoes-section">
            <div class="acoes-header">
                <h3>üìã A√ß√µes Realizadas Durante a Visita</h3>
                <button class="btn-add" onclick="adicionarAcao()">+ Adicionar A√ß√£o</button>
            </div>
            <div id="acoesContainer">
                <div class="acao-item">
                    <input type="text" value="Realiza√ß√£o do check list padr√£o de acompanhamento de central">
                    <button class="btn-remove" onclick="removerAcao(this)">‚úï</button>
                </div>
                <div class="acao-item">
                    <input type="text" value="Manuten√ß√£o da ret√≠fica">
                    <button class="btn-remove" onclick="removerAcao(this)">‚úï</button>
                </div>
                <div class="acao-item">
                    <input type="text" value="Realiza√ß√£o de aferi√ß√£o da prensa">
                    <button class="btn-remove" onclick="removerAcao(this)">‚úï</button>
                </div>
                <div class="acao-item">
                    <input type="text" value="Curva de inchamento">
                    <button class="btn-remove" onclick="removerAcao(this)">‚úï</button>
                </div>
                <div class="acao-item">
                    <input type="text" value="Teste com novo MCC">
                    <button class="btn-remove" onclick="removerAcao(this)">‚úï</button>
                </div>
            </div>
        </div>

        <!-- Conclus√£o Manual -->
        <div class="conclusao-section">
            <h3>üìù Conclus√£o do Relat√≥rio</h3>
            <textarea id="conclusaoManual" placeholder="Digite aqui a conclus√£o personalizada...">A unidade de Porto Velho n√£o apresenta resultados abaixo do fck. A visita teve como objetivo principal a identifica√ß√£o de oportunidades de melhoria nos processos, tendo sido observadas possibilidades de otimiza√ß√£o no desempenho da ret√≠fica, bem como a avalia√ß√£o de um novo MCC para o concreto. Apesar de, durante a visita de campo, ter sido identificado um abatimento (slump) fora do padr√£o especificado, a equipe de motoristas mostrou-se bem alinhada aos procedimentos operacionais. Destaca-se, ainda, o excelente trabalho desenvolvido pelos laboratoristas Ricardo e Adriano, que contribuem de forma significativa para a qualidade e confiabilidade dos resultados da unidade.</textarea>
        </div>

        <!-- Bot√µes de Exporta√ß√£o -->
        <div class="export-buttons">
            <button class="btn-primary" onclick="gerarRelatorioWord()">üìÑ EXPORTAR PARA WORD</button>
            <button class="btn-primary btn-danger" onclick="gerarRelatorioPDF()">üìë EXPORTAR PARA PDF</button>
        </div>
    </div>

    <script>
        // Checklist completo (mesmo do c√≥digo anterior)
        const checklistData = {
            "P√ÅTIO DE MATERIAIS": {
                grupo: "maquinas",
                itens: [
                    "AREIA NATURAL - CONDI√á√ÉO DE ESTOCAGEM",
                    "AREIA NATURAL - CONTAMINA√á√ïES",
                    "AREIA NATURAL - AMOSTRA PADR√ÉO - EXIST√äNCIA",
                    "ENSAIOS EXECUTADOS E LAN√áADOS NA INTRANET",
                    "AREIA ARTIFICIAL - CONDI√á√ÉO DE ESTOCAGEM",
                    "AREIA ARTIFICIAL - CONTAMINA√á√ïES",
                    "AREIA ARTIFICIAL - AMOSTRA PADR√ÉO - EXIST√äNCIA",
                    "ENSAIOS EXECUTADOS E LAN√áADOS NA INTRANET",
                    "BRITA 0 - CONDI√á√ÉO DE ESTOCAGEM",
                    "BRITA 0 - CONTAMINA√á√ïES",
                    "BRITA 0 - AMOSTRA PADR√ÉO - EXIST√äNCIA",
                    "BRITA 0 - ASPERSORES EFICIENTES",
                    "ENSAIOS EXECUTADOS E LAN√áADOS NA INTRANET",
                    "BRITA 1 - CONDI√á√ÉO DE ESTOCAGEM",
                    "BRITA 1 - CONTAMINA√á√ïES",
                    "BRITA 1 - AMOSTRA PADR√ÉO - EXIST√äNCIA",
                    "BRITA 1 - ASPERSORES EFICIENTES",
                    "ENSAIOS EXECUTADOS E LAN√áADOS NA INTRANET",
                    "ADITIVO - DIQUE DE CONTEN√á√ÉO",
                    "ADITIVO - TANQUES",
                    "ADITIVO - RECIRCULA√á√ÉO COM BOMBAS",
                    "ADITIVO - DENSIDADE NO RECEBIMENTO",
                    "ADITIVO - AMOSTRAS DE RETEN√á√ÉO",
                    "TAMBORES E CONTENTORES DO P√ÅTIO",
                    "SADA - DIQUE DE CONTEN√á√ÉO",
                    "SADA - TANQUES",
                    "SADA - RECIRCULA√á√ÉO COM BOMBAS",
                    "SADA - SISTEMA DE PESAGEM",
                    "SADA - DENSIDADE NO RECEBIMENTO",
                    "SADA - AMOSTRAS DE RETEN√á√ÉO",
                    "CIMENTO - SILOS IDENTIFICADOS",
                    "CIMENTO - AMOSTRAS DE RETEN√á√ÉO",
                    "CONDI√á√ÉO DA SILICA EM SACOS NO P√ÅTIO",
                    "CONDI√á√ÉO DOS INSUMOS DA ARGAMASSA",
                    "PRESEN√áA DE ADITIVOS EM TAMBORES/CONTENTORES"
                ]
            },
            "BATE LASTRO E RES√çDUOS": {
                grupo: "maquinas",
                itens: [
                    "PRESEN√áA DE ESPUMA",
                    "ENTUPIDO",
                    "RES√çDUOS ACUMULADOS",
                    "PRESEN√áA DE ADITIVOS",
                    "LIMPEZA GERAL DA CENTRAL"
                ]
            },
            "PONTO DE CARGA": {
                grupo: "maquinas",
                itens: [
                    "ENCLAUSURAMENTO",
                    "ASPERSORES",
                    "MATERIAL NO CH√ÉO",
                    "SAIA RASGADA"
                ]
            },
            "CENTRAL DOSADORA": {
                grupo: "maquinas",
                itens: [
                    "CAIXA DE AGREGADO - CONTAMINA√á√ÉO",
                    "CORREIAS TRANSPORTADORAS",
                    "BALAN√áA DE AGREGADOS - CONDI√á√ïES",
                    "BALAN√áA DE AGREGADOS - C√âLULA DE CARGA",
                    "BALAN√áA DE AGREGADOS - AFERI√á√ÉO",
                    "BALAN√áA DE CIMENTO - CONDI√á√ïES",
                    "BALAN√áA DE CIMENTO - C√âLULA DE CARGA",
                    "BALAN√áA DE CIMENTO - AFERI√á√ÉO",
                    "BALAN√áA DE CIMENTO - FILTRO",
                    "BALAN√áA DE CIMENTO - MANGOTE FLEX√çVEL",
                    "BALAN√áA DE ADITIVO - CONDI√á√ïES",
                    "BALAN√áA DE ADITIVO - C√âLULA DE CARGA",
                    "BALAN√áA DE ADITIVO - AFERI√á√ÉO",
                    "EXISTE ADITIVO DOSADO MANUAL"
                ]
            },
            "PESAGEM": {
                grupo: "maquinas",
                itens: [
                    "SEQU√äNCIA DE CARREGAMENTO CONCRETO",
                    "SEQU√äNCIA DE CARREGAMENTO ARGAMASSA",
                    "UMIDADE DAS AREIAS NO SISTEMA",
                    "SONDAS DE UMIDADE",
                    "VERIFICA√á√ÉO RELAT√ìRIOS DE AUTOMA√á√ÉO",
                    "CORTE DE √ÅGUA"
                ]
            },
            "CAMINH√ïES": {
                grupo: "maquinas",
                itens: [
                    "PRESEN√áA DE SLUMPMIX",
                    "FACAS",
                    "CONCRETO ADERIDO",
                    "HIDR√îMETRO",
                    "VELOCIDADE DO GIRO",
                    "KIT DE MOLDAGEM / SLUMP TEST",
                    "CAMINH√ÉO DE ARGAMASSA TRANSPORTANDO CONCRETO"
                ]
            },
            "LABORAT√ìRIO": {
                grupo: "laboratorio",
                itens: [
                    "CONDI√á√ïES DAS FORMAS PL√ÅSTICAS",
                    "DESFORMA - PRESS√ÉO DE AR",
                    "CONDI√á√ÉO CARRO COLETA",
                    "TEMPO M√âDIO DE COLETA",
                    "AVALIAR RELAT√ìRIO DE EXCLUS√ïES",
                    "CONDI√á√ÉO DO FRASCO DE CHAPMAN",
                    "CONDI√á√ÉO DAS PENEIRAS",
                    "TEMPERATURA DO TANQUE",
                    "FUNCIONAMENTO AQUECEDORES",
                    "RET√çFICA - CONDI√á√ïES",
                    "RET√çFICA - ESPESSURA DO CORTE",
                    "RET√çFICA - PRESS√ÉO DE AR",
                    "PRENSA - CONDI√á√ïES",
                    "PRENSA - AFERI√á√ÉO",
                    "PRENSA - VAZAMENTOS",
                    "PRENSA - PLANICIDADE DOS PRATOS",
                    "PRENSA - TESTE DO CARBANO"
                ]
            },
            "ARGAMASSA": {
                grupo: "laboratorio",
                itens: [
                    "AMOSTRA DE RETEN√á√ÉO ARGAMASSA",
                    "EXPEDI√á√ÉO - TEOR DE AR E SLUMP - REGISTROS",
                    "MOLDAGENS DE PRISMAS",
                    "MOLDAGENS DE PLACAS"
                ]
            },
            "EQUIPE": {
                grupo: "pessoas",
                itens: [
                    "TREINAMENTO MOTORISTAS",
                    "ATA DE REGISTRO",
                    "TREINAMENTO BALANCEIRO",
                    "ATA DE REGISTRO",
                    "VISITA SURPRESA",
                    "APLICA√á√ÉO DE ADVERT√äNCIAS"
                ]
            },
            "DEMANDA DE √ÅGUA": {
                grupo: "pessoas",
                itens: [
                    "FILIAL REALIZA O PROCEDIMENTO",
                    "SOBRA M√âDIA FILIAL",
                    "SOBRA M√âDIA INSPE√á√ÉO"
                ]
            }
        };

        // Estado da aplica√ß√£o
        let inspecao = {};
        let currentGrupo = 'maquinas';
        let currentSector = 'P√ÅTIO DE MATERIAIS';

        // Inicializar
        function initInspecao() {
            for (let sector in checklistData) {
                inspecao[sector] = {};
                checklistData[sector].itens.forEach(item => {
                    let status = null;
                    let observacao = '';
                    
                    // Dados de exemplo
                    if (sector === 'P√ÅTIO DE MATERIAIS' && item.includes('CONTAMINA√á√ïES')) {
                        status = 'nconforme';
                        observacao = 'Presen√ßa de material org√¢nico';
                    } else if (sector === 'CAMINH√ïES' && item.includes('HIDR√îMETRO')) {
                        status = 'nconforme';
                        observacao = 'BT 1572 com diverg√™ncia';
                    } else if (sector === 'LABORAT√ìRIO' && item.includes('RET√çFICA')) {
                        status = 'nconforme';
                        observacao = 'Rolamento danificado';
                    } else if (sector === 'DEMANDA DE √ÅGUA' && item.includes('PROCEDIMENTO')) {
                        status = 'conforme';
                        observacao = 'Procedimento realizado corretamente';
                    } else if (sector === 'DEMANDA DE √ÅGUA' && item.includes('SOBRA M√âDIA FILIAL')) {
                        status = 'conforme';
                        observacao = '145 L/m¬≥';
                    } else if (sector === 'DEMANDA DE √ÅGUA' && item.includes('SOBRA M√âDIA INSPE√á√ÉO')) {
                        status = 'conforme';
                        observacao = '132 L/m¬≥';
                    } else {
                        status = 'conforme';
                    }
                    
                    inspecao[sector][item] = {
                        status: status,
                        observacao: observacao,
                        foto: null,
                        fotoNome: ''
                    };
                });
            }
            renderSectorTabs();
            renderChecklist();
            updateProgress();
            atualizarGraficos();
        }

        // Renderizar abas de setor
        function renderSectorTabs() {
            const container = document.getElementById('sectorTabs');
            container.innerHTML = '';
            
            for (let sector in checklistData) {
                if (checklistData[sector].grupo === currentGrupo) {
                    const tab = document.createElement('span');
                    tab.className = `sector-tab ${sector === currentSector ? 'active' : ''}`;
                    tab.textContent = sector;
                    tab.onclick = () => {
                        currentSector = sector;
                        document.querySelectorAll('.sector-tab').forEach(t => t.classList.remove('active'));
                        tab.classList.add('active');
                        renderChecklist();
                    };
                    container.appendChild(tab);
                }
            }
        }

        // Renderizar checklist
        function renderChecklist() {
            const container = document.getElementById('checklistContainer');
            if (!checklistData[currentSector]) return;
            
            const items = checklistData[currentSector].itens;
            
            let html = `<div class="sector-title">${currentSector}</div>`;
            
            items.forEach(item => {
                const itemData = inspecao[currentSector]?.[item] || { status: null, observacao: '', foto: null };
                const itemClass = itemData.status === 'conforme' ? 'conforme' : 
                                 itemData.status === 'nconforme' ? 'nconforme' : '';
                const itemId = `item-${currentSector}-${item.replace(/[^\w\s]/g, '').replace(/\s+/g, '-')}`;
                
                html += `
                    <div class="checklist-item ${itemClass}" id="${itemId}">
                        <div class="item-header">
                            <span class="item-desc">${item}</span>
                            <div class="status-buttons">
                                <button class="status-btn btn-conforme ${itemData.status === 'conforme' ? 'active' : ''}" 
                                        onclick="setStatus('${currentSector}', '${item.replace(/'/g, "\\'")}', 'conforme')">
                                    CONFORME
                                </button>
                                <button class="status-btn btn-nconforme ${itemData.status === 'nconforme' ? 'active' : ''}" 
                                        onclick="setStatus('${currentSector}', '${item.replace(/'/g, "\\'")}', 'nconforme')">
                                    N√ÉO CONFORME
                                </button>
                            </div>
                        </div>
                        <div class="observation-area">
                            <input type="text" class="observation-input" 
                                   placeholder="Observa√ß√£o..." 
                                   value="${itemData.observacao || ''}"
                                   onchange="setObservacao('${currentSector}', '${item.replace(/'/g, "\\'")}', this.value)">
                            <div class="photo-upload">
                                <label class="photo-btn" for="foto-${itemId}">
                                    üì∑ ANEXAR FOTO
                                </label>
                                <input type="file" id="foto-${itemId}" 
                                       accept="image/*" onchange="handlePhoto(event, '${currentSector}', '${item.replace(/'/g, "\\'")}')">
                            </div>
                        </div>
                        <div id="preview-${itemId}" style="display: flex; flex-wrap: wrap; gap: 10px; margin-top: 10px;">
                            ${itemData.foto ? `<img src="${itemData.foto}" class="photo-preview" onclick="window.open(this.src)">` : ''}
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        function setStatus(sector, item, status) {
            if (!inspecao[sector]) inspecao[sector] = {};
            if (!inspecao[sector][item]) inspecao[sector][item] = { status: null, observacao: '', foto: null };
            
            if (inspecao[sector][item].status === status) {
                inspecao[sector][item].status = null;
            } else {
                inspecao[sector][item].status = status;
            }
            updateProgress();
            atualizarGraficos();
            renderChecklist();
        }

        function setObservacao(sector, item, value) {
            if (!inspecao[sector]) inspecao[sector] = {};
            if (!inspecao[sector][item]) inspecao[sector][item] = { status: null, observacao: '', foto: null };
            inspecao[sector][item].observacao = value;
            
            if (sector === 'DEMANDA DE √ÅGUA') {
                if (item.includes('SOBRA M√âDIA FILIAL')) {
                    const valor = parseInt(value) || 145;
                    document.getElementById('sobraFilial').textContent = valor;
                    document.getElementById('valorFilial').textContent = valor + ' L';
                    document.getElementById('barraFilial').style.height = valor + 'px';
                }
                if (item.includes('SOBRA M√âDIA INSPE√á√ÉO')) {
                    const valor = parseInt(value) || 132;
                    document.getElementById('sobraInspecao').textContent = valor;
                    document.getElementById('valorInspecao').textContent = valor + ' L';
                    document.getElementById('barraInspecao').style.height = valor + 'px';
                }
                if (item.includes('PROCEDIMENTO')) {
                    document.getElementById('procedimentoStatus').innerHTML = value.toLowerCase().includes('n√£o') ? '‚úó' : '‚úì';
                }
                atualizarGraficos();
            }
        }

        function handlePhoto(event, sector, item) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    if (!inspecao[sector]) inspecao[sector] = {};
                    if (!inspecao[sector][item]) inspecao[sector][item] = { status: null, observacao: '', foto: null };
                    inspecao[sector][item].foto = e.target.result;
                    inspecao[sector][item].fotoNome = file.name;
                    renderChecklist();
                };
                reader.readAsDataURL(file);
            }
        }

        function mudarGrupo(grupo, element) {
            currentGrupo = grupo;
            document.querySelectorAll('.group-tab').forEach(t => t.classList.remove('active'));
            element.classList.add('active');
            
            for (let sector in checklistData) {
                if (checklistData[sector].grupo === grupo) {
                    currentSector = sector;
                    break;
                }
            }
            
            renderSectorTabs();
            renderChecklist();
        }

        function adicionarAcao() {
            const container = document.getElementById('acoesContainer');
            const novaAcao = document.createElement('div');
            novaAcao.className = 'acao-item';
            novaAcao.innerHTML = `
                <input type="text" placeholder="Descreva a a√ß√£o realizada...">
                <button class="btn-remove" onclick="removerAcao(this)">‚úï</button>
            `;
            container.appendChild(novaAcao);
        }

        function removerAcao(btn) {
            if (document.querySelectorAll('.acao-item').length > 1) {
                btn.closest('.acao-item').remove();
            }
        }

        function updateProgress() {
            let total = 0;
            let conforme = 0;
            let nconforme = 0;
            
            for (let sector in inspecao) {
                for (let item in inspecao[sector]) {
                    total++;
                    if (inspecao[sector][item]?.status === 'conforme') conforme++;
                    if (inspecao[sector][item]?.status === 'nconforme') nconforme++;
                }
            }
            
            const pendente = total - conforme - nconforme;
            const progresso = ((conforme + nconforme) / total) * 100;
            
            document.getElementById('totalItens').textContent = total;
            document.getElementById('conformeCount').textContent = conforme;
            document.getElementById('nconformeCount').textContent = nconforme;
            document.getElementById('pendenteCount').textContent = pendente;
            document.getElementById('progressBar').style.width = progresso + '%';
            
            const percentConforme = total > 0 ? (conforme / total) * 100 : 0;
            document.getElementById('pieChart').style.background = 
                `conic-gradient(#C41E3A 0% ${percentConforme}%, #666 ${percentConforme}% 100%)`;
        }

        function atualizarGraficos() {
            const grupos = {
                maquinas: { conforme: 0, total: 0 },
                laboratorio: { conforme: 0, total: 0 },
                pessoas: { conforme: 0, total: 0 }
            };
            
            for (let sector in inspecao) {
                const grupo = checklistData[sector]?.grupo;
                if (grupo) {
                    for (let item in inspecao[sector]) {
                        grupos[grupo].total++;
                        if (inspecao[sector][item]?.status === 'conforme') {
                            grupos[grupo].conforme++;
                        }
                    }
                }
            }
            
            const grupoChart = document.getElementById('grupoChart');
            grupoChart.innerHTML = '';
            
            for (let grupo in grupos) {
                const total = grupos[grupo].total;
                const conforme = grupos[grupo].conforme;
                const percentual = total > 0 ? (conforme / total) * 100 : 0;
                
                const barItem = document.createElement('div');
                barItem.className = 'bar-item';
                barItem.innerHTML = `
                    <div class="bar-value">${conforme}/${total}</div>
                    <div class="bar" style="height: ${percentual}px; background: #C41E3A;"></div>
                    <div class="bar-label">${grupo === 'maquinas' ? 'M√°quinas' : grupo === 'laboratorio' ? 'Lab' : 'Equipe'}</div>
                `;
                grupoChart.appendChild(barItem);
            }
            
            const sobraFilial = parseInt(document.getElementById('sobraFilial').textContent) || 145;
            const sobraInspecao = parseInt(document.getElementById('sobraInspecao').textContent) || 132;
            
            const aguaChart = document.getElementById('aguaChart');
            aguaChart.innerHTML = '';
            
            const barFilial = document.createElement('div');
            barFilial.className = 'bar-item';
            barFilial.innerHTML = `
                <div class="bar-value">${sobraFilial}L</div>
                <div class="bar" style="height: ${sobraFilial}px; background: #333;"></div>
                <div class="bar-label">Filial</div>
            `;
            
            const barInspecao = document.createElement('div');
            barInspecao.className = 'bar-item';
            barInspecao.innerHTML = `
                <div class="bar-value">${sobraInspecao}L</div>
                <div class="bar" style="height: ${sobraInspecao}px; background: #C41E3A;"></div>
                <div class="bar-label">Inspe√ß√£o</div>
            `;
            
            aguaChart.appendChild(barFilial);
            aguaChart.appendChild(barInspecao);
            
            const economia = sobraFilial - sobraInspecao;
            const percentualEconomia = Math.round((economia / sobraFilial) * 100);
            document.getElementById('economiaAgua').textContent = economia;
            document.getElementById('economiaAgua').nextElementSibling.textContent = `litros/m¬≥ (${percentualEconomia}%)`;
        }

        function gerarRelatorioWord() {
            const filial = document.getElementById('filial').value || 'N√ÉO INFORMADO';
            const periodoInicio = document.getElementById('periodoInicio').value || '____';
            const periodoFim = document.getElementById('periodoFim').value || '____';
            const gerente = document.getElementById('gerente').value || 'N√ÉO INFORMADO';
            const inspetor = document.getElementById('inspetor').value || 'N√ÉO INFORMADO';
            const supervisor = document.getElementById('supervisor').value || 'N√ÉO INFORMADO';
            const conclusaoManual = document.getElementById('conclusaoManual').value || '';
            
            const dataAtual = new Date().toLocaleDateString('pt-BR');
            
            const acoes = [];
            document.querySelectorAll('.acao-item input').forEach(input => {
                if (input.value.trim()) {
                    acoes.push(input.value.trim());
                }
            });
            
            const grupos = {
                maquinas: { titulo: 'üè≠ M√ÅQUINAS E EQUIPAMENTOS', itens: [], fotos: [], conformes: 0, total: 0 },
                laboratorio: { titulo: 'üî¨ LABORAT√ìRIO E MCC', itens: [], fotos: [], conformes: 0, total: 0 },
                pessoas: { titulo: 'üë• PESSOAS E EQUIPE', itens: [], fotos: [], conformes: 0, total: 0 }
            };
            
            for (let sector in inspecao) {
                const grupo = checklistData[sector]?.grupo;
                if (grupo) {
                    for (let item in inspecao[sector]) {
                        grupos[grupo].total++;
                        if (inspecao[sector][item]?.status === 'conforme') {
                            grupos[grupo].conformes++;
                        }
                        if (inspecao[sector][item]?.status === 'nconforme') {
                            grupos[grupo].itens.push({
                                setor: sector,
                                item: item,
                                obs: inspecao[sector][item].observacao || 'Sem observa√ß√µes'
                            });
                        }
                        if (inspecao[sector][item]?.foto) {
                            grupos[grupo].fotos.push({
                                setor: sector,
                                item: item,
                                foto: inspecao[sector][item].foto
                            });
                        }
                    }
                }
            }
            
            const sobraFilial = document.getElementById('sobraFilial').textContent;
            const sobraInspecao = document.getElementById('sobraInspecao').textContent;
            
            let reportHTML = `
                <html>
                <head>
                    <meta charset="UTF-8">
                    <title>Relat√≥rio SUPERMIX - ${filial}</title>
                    <style>
                        body { font-family: 'Segoe UI', Arial, sans-serif; max-width: 1000px; margin: 0 auto; padding: 40px; }
                        h1 { color: #333; text-align: center; font-size: 2.5em; }
                        h2 { color: #C41E3A; text-align: center; font-weight: 400; }
                        .header { text-align: center; border-bottom: 3px solid #C41E3A; padding-bottom: 20px; margin-bottom: 30px; }
                        .info { background: #f5f5f5; padding: 15px; border-radius: 8px; margin: 20px 0; display: grid; grid-template-columns: repeat(auto-fit, minmax(200px,1fr)); gap: 10px; }
                        .group-box { margin: 30px 0; padding: 20px; background: #f5f5f5; border-left: 4px solid #C41E3A; border-radius: 8px; }
                        table { width: 100%; border-collapse: collapse; margin: 15px 0; }
                        th { background: #333; color: white; padding: 10px; }
                        td { padding: 8px; border-bottom: 1px solid #ddd; }
                        .photo-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(150px,1fr)); gap: 15px; margin: 20px 0; }
                        .photo-item { text-align: center; }
                        .photo-item img { width: 150px; height: 150px; object-fit: cover; border-radius: 8px; border: 2px solid #C41E3A; }
                        .signature { margin-top: 50px; display: flex; justify-content: space-around; }
                        .signature-line { text-align: center; min-width: 200px; }
                        .signature-line p { margin-top: 40px; border-top: 2px solid #C41E3A; padding-top: 5px; }
                    </style>
                </head>
                <body>
                    <div class="header">
                        <h1>SUPERMIX</h1>
                        <h2>facilitando a constru√ß√£o civil</h2>
                        <p>ORGULHO DE FAZER PARTE DESTA HIST√ìRIA.</p>
                        <h3 style="margin-top: 20px;">RELAT√ìRIO T√âCNICO DE INSPE√á√ÉO</h3>
                    </div>
                    
                    <div class="info">
                        <div><strong>Filial:</strong> ${filial}</div>
                        <div><strong>Per√≠odo:</strong> ${periodoInicio} a ${periodoFim}</div>
                        <div><strong>Inspetor:</strong> ${inspetor}</div>
                        <div><strong>Gerente:</strong> ${gerente}</div>
                        <div><strong>Supervisor:</strong> ${supervisor}</div>
                        <div><strong>Data:</strong> ${dataAtual}</div>
                    </div>
                    
                    <h3>1. A√á√ïES REALIZADAS</h3>
                    <ul>${acoes.map(a => `<li>${a}</li>`).join('')}</ul>
            `;
            
            for (let g in grupos) {
                const grupo = grupos[g];
                const percentual = grupo.total > 0 ? Math.round((grupo.conformes/grupo.total)*100) : 0;
                
                reportHTML += `
                    <div class="group-box">
                        <h3>${grupo.titulo}</h3>
                        <p><strong>Conformidade:</strong> ${grupo.conformes}/${grupo.total} (${percentual}%)</p>
                        <div style="width:100%; height:20px; background:#eee; border-radius:10px; margin:10px 0;">
                            <div style="width:${percentual}%; height:20px; background:#C41E3A; border-radius:10px;"></div>
                        </div>
                `;
                
                if (grupo.itens.length > 0) {
                    reportHTML += `<table><tr><th>Setor</th><th>Item</th><th>Observa√ß√£o</th></tr>`;
                    grupo.itens.forEach(i => {
                        reportHTML += `<tr><td>${i.setor}</td><td>${i.item}</td><td>${i.obs}</td></tr>`;
                    });
                    reportHTML += `</table>`;
                }
                
                if (grupo.fotos.length > 0) {
                    reportHTML += `<div class="photo-grid">`;
                    grupo.fotos.forEach(f => {
                        reportHTML += `<div class="photo-item"><img src="${f.foto}"><div class="caption">${f.setor}</div></div>`;
                    });
                    reportHTML += `</div>`;
                }
                
                reportHTML += `</div>`;
            }
            
            reportHTML += `
                    <h3>2. DEMANDA DE √ÅGUA</h3>
                    <table>
                        <tr><th>Indicador</th><th>Valor</th></tr>
                        <tr><td>Filial</td><td>${sobraFilial} L/m¬≥</td></tr>
                        <tr><td>Inspe√ß√£o</td><td>${sobraInspecao} L/m¬≥</td></tr>
                        <tr><td>Economia</td><td>${sobraFilial - sobraInspecao} L/m¬≥</td></tr>
                    </table>
                    
                    <h3>3. CONCLUS√ÉO</h3>
                    <p>${conclusaoManual}</p>
                    
                    <div class="signature">
                        <div class="signature-line">______________________________<p>${inspetor}</p></div>
                        <div class="signature-line">______________________________<p>${gerente}</p></div>
                        <div class="signature-line">______________________________<p>${supervisor}</p></div>
                    </div>
                </body>
                </html>
            `;
            
            const blob = new Blob([reportHTML], { type: 'application/msword' });
            saveAs(blob, `Relatorio_Supermix_${filial}_${dataAtual.replace(/\//g, '-')}.doc`);
        }

        function gerarRelatorioPDF() {
            alert('Use a exporta√ß√£o para Word e depois salve como PDF para melhor qualidade.');
        }

        initInspecao();
    </script>
</body>
</html>